<!DOCTYPE html>
<html lang="es"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Publicación de un API en Netlify y Consumo con Google Sheets [Parte 1] | MaxiCode</title>
<meta property="og:title" content="Publicación de un API en Netlify y Consumo con Google Sheets [Parte 1] | MaxiCode" />
<meta name="twitter:title" content="Publicación de un API en Netlify y Consumo con Google Sheets [Parte 1] | MaxiCode" />
<meta itemprop="name" content="Publicación de un API en Netlify y Consumo con Google Sheets [Parte 1] | MaxiCode" />
<meta name="application-name" content="Publicación de un API en Netlify y Consumo con Google Sheets [Parte 1] | MaxiCode" />
<meta property="og:site_name" content="Libertad-Digital" />

<meta name="description" content="Publicación de un API en Netlify y Consumo con Google Sheets">
<meta itemprop="description" content="Publicación de un API en Netlify y Consumo con Google Sheets" />
<meta property="og:description" content="Publicación de un API en Netlify y Consumo con Google Sheets" />
<meta name="twitter:description" content="Publicación de un API en Netlify y Consumo con Google Sheets" />

<meta property="og:locale" content="es" />
<meta name="language" content="es" />

  <link rel="alternate" hreflang="es" href="https://hba.sid.one/entradas/deploy-api-netlify-sheet/" title="Español" />



  <meta itemprop="image" content="https://hba.sid.one/" />
  <meta property="og:image" content="https://hba.sid.one/" />
  <meta name="twitter:image" content="https://hba.sid.one/" />
  <meta name="twitter:image:src" content="https://hba.sid.one/" />





<meta name="generator" content="Hugo 0.122.0">

    

    <link rel="canonical" href="https://hba.sid.one/entradas/deploy-api-netlify-sheet/">
    <link href="/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://hba.sid.one/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NN0TQ469BP"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-NN0TQ469BP', { 'anonymize_ip': false });
}
</script>
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://hba.sid.one/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Inicio
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/entradas/">
                        Entradas
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        Acerca de
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Publicación de un API en Netlify y Consumo con Google Sheets [Parte 1]</h1>
                
                
                <div class="post-meta">
                    <time datetime="2024-03-11T00:00:00&#43;00:00" itemprop="datePublished"> 11 mar. 2024 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b></b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#fuente-de-información-y-metodología">Fuente de Información y Metodología</a></li>
    <li><a href="#api-info-dolarjs">Api info-dolar.js</a>
      <ul>
        <li><a href="#función-handler-y-su-importancia">Función Handler y su Importancia</a></li>
        <li><a href="#estructura-de-carpetas-del-api">Estructura de carpetas del API</a></li>
        <li><a href="#archivo-toml">Archivo toml</a></li>
      </ul>
    </li>
    <li><a href="#crear-cuenta-en-netlify-y-publicar-api-functions">Crear cuenta en Netlify y publicar API-Functions</a></li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <p>En este artículo, exploraremos cómo publicar un API en Netlify y luego consumirla utilizando Google Sheets. El ejemplo que vamos a desarrollar se centra en un API que proporciona las cuatro cotizaciones del dólar más importantes en Argentina:</p>
<ul>
<li>Dólar Libre</li>
<li>Dólar Banco Nación</li>
<li>Dólar MEP</li>
<li>Dólar Tarjeta/Turista</li>
</ul>
<h2 id="fuente-de-información-y-metodología">Fuente de Información y Metodología</h2>
<p>La fuente de información para nuestro API es el sitio <a href="https://www.infobae.com/economia/divisas/dolar-hoy/">Infobae - Dólar Hoy</a>. Utilizaremos la técnica de &ldquo;scraping&rdquo; para obtener los datos de las cotizaciones del dólar desde este sitio web.</p>
<p><img src="/entradas/p1-dolar-infobae.png" alt="Infobae Dólar Hoy"></p>
<p>El &ldquo;scraping&rdquo; es un proceso automatizado mediante el cual extraemos información de páginas web. Esto nos permite recopilar datos de interés de manera eficiente y utilizarlos en nuestras aplicaciones. En este caso específico, utilizaremos el &ldquo;scraping&rdquo; para obtener las cotizaciones del dólar de Infobae y posteriormente exponerlas a través de un API en Netlify.</p>
<p>En la próxima sección, profundizaremos en el proceso de &ldquo;scraping&rdquo; y cómo podemos implementarlo para obtener los datos necesarios. Además, aprenderemos cómo configurar y desplegar este API en Netlify para que esté disponible públicamente. ¡Comencemos!</p>
<h2 id="api-info-dolarjs">Api info-dolar.js</h2>
<p>Lo primero que hay que hacer es tener el API versionada en GitHub.</p>
<p>El código completo del API en JavaScript se puede encontrar en el siguiente repositorio de GitHub:</p>
<ul>
<li><a href="https://github.com/ottino/api-info-dolar">api-info-dolar</a></li>
</ul>
<p>El API consta principalmente de cuatro funciones, una para obtener cada tipo de dólar, y luego la función handler necesaria para publicarla en Netlify.</p>
<p>Parte del código:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">export</span> <span class="kr">async</span> <span class="kd">function</span> <span class="nx">handler</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">dolarLibre</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">getDolarLibre</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">dolarBancoNacion</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">getDolarBancoNacion</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">dolarTurista</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">getDolarTurista</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">dolarMEP</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">getDolarMEP</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">statusCode</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">dolarLibre</span><span class="p">,</span> <span class="nx">dolarBancoNacion</span><span class="p">,</span> <span class="nx">dolarTurista</span><span class="p">,</span> <span class="nx">dolarMEP</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error al obtener los valores del dólar:&#39;</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">statusCode</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;Error al obtener los valores del dólar&#39;</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="función-handler-y-su-importancia">Función Handler y su Importancia</h3>
<p>La función handler es esencial en una función de servidor que se despliega en Netlify. En este caso específico, estamos utilizando Netlify Functions, que es una característica que permite ejecutar código del lado del servidor en respuesta a solicitudes HTTP.</p>
<p>Cuando Netlify recibe una solicitud HTTP dirigida a la URL específica de nuestra función, ésta activa la función handler. La función handler es responsable de manejar la solicitud entrante y devolver una respuesta adecuada. En este caso, la función handler se encarga de coordinar las diferentes llamadas a funciones para obtener las diferentes cotizaciones.</p>
<h3 id="estructura-de-carpetas-del-api">Estructura de carpetas del API</h3>
<p>Es crucial prestar atención a la siguiente estructura de carpetas, ya que es fundamental para que Netlify pueda desplegar el API-Functions correctamente:</p>
<p><img src="/entradas/p1-estructura-carpetas.png" alt="Estructura de carpetas"></p>
<ul>
<li>
<p>La carpeta <code>functions</code> contiene todas las funciones de servidor (en nuestro caso, las funciones API) que queremos desplegar en Netlify. Cada función debe estar contenida en un archivo js separado dentro de subcarpetas con el mismo nombre de la funcion.</p>
</li>
<li>
<p>El archivo <code>info-dolar.js</code> dentro de <code>functions\info-dolar</code> es el archivo que contiene nuestra función API para obtener información sobre las cotizaciones del dólar.</p>
</li>
</ul>
<p>Es importante seguir esta estructura de carpetas para que Netlify pueda detectar y desplegar correctamente nuestras funciones API. En la siguiente sección, veremos cómo configurar y desplegar estas funciones en Netlify.</p>
<h3 id="archivo-toml">Archivo toml</h3>
<p>Es importante tener un archivo TOML correctamente configurado para tu proyecto en Netlify. A continuación, te muestro un ejemplo de cómo debería lucir:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[</span><span class="nx">build</span><span class="p">.</span><span class="nx">environment</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">NODE_VERSION</span> <span class="p">=</span> <span class="s2">&#34;18.16.0&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">functions</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">node_bundler</span> <span class="p">=</span> <span class="s2">&#34;esbuild&#34;</span>  
</span></span></code></pre></div><h2 id="crear-cuenta-en-netlify-y-publicar-api-functions">Crear cuenta en Netlify y publicar API-Functions</h2>
<p>Para comenzar, necesitas crear una cuenta en Netlify y luego publicar tu API-Functions. Sigue estos pasos:</p>
<ol>
<li>
<p>Ingresa al siguiente sitio: <a href="https://www.netlify.com/">Netlify</a></p>
</li>
<li>
<p>Una vez en la página de inicio de Netlify, busca y haz clic en el botón &ldquo;Sign Up&rdquo; (Registrarse) ubicado en la esquina superior derecha de la página.</p>
</li>
<li>
<p>Completa el formulario de registro con tu dirección de correo electrónico y una contraseña segura. También puedes registrarte utilizando tu cuenta de GitHub, GitLab o Bitbucket si lo prefieres.</p>
</li>
<li>
<p>Una vez dentro del panel de control, dirígete a la opción &ldquo;Sites&rdquo;. Allí, verás la opción &ldquo;Add new site&rdquo;.</p>
</li>
</ol>
<p><img src="/entradas/p1-netlify-import.png" alt="Añadir nuevo sitio"></p>
<p>Los siguientes pasos son:</p>
<ul>
<li>Conectarse al proveedor Git.</li>
<li>Seleccionar el repositorio.</li>
<li>Configurar el sitio y realizar el despliegue.</li>
</ul>
<p>¡Listo! Ahora tienes una cuenta en Netlify y has conectado tu repositorio, lo que permite un despliegue sincronizado automáticamente.
Cada vez que hagas push sobre tu repositorio automaticament netlify va a realizar un deploy para ver reflejados tus cambios en producción.</p>
<p><img src="/entradas/p1-netlify-deploy.png" alt="alt text"></p>
<p>Si has seguido todos los pasos hasta aquí, ahora deberías poder acceder a la URL que te ha asignado Netlify y ver lo siguiente:</p>
<p><img src="/entradas/p1-netlify-api.png" alt="Captura de pantalla de la API desplegada en Netlify"></p>
<p>Esta captura de pantalla muestra la respuesta de la API que hemos desplegado en Netlify. Es un gran hito haber llegado hasta aquí, ya que significa que has configurado correctamente tu API y la has desplegado en un entorno en vivo.</p>
<p>En la próxima parte de esta serie, profundizaremos en cómo consumir esta API desde Google Sheets y crear un flujo automatizado para actualizar los datos de las cotizaciones del dolar.</p>
<p>¡Sigue atento para la parte 2! Si tienes alguna sugerencia o duda, no dudes en contactarme a través de mi correo electrónico: <a href="mailto:maxi.ottino@gmail.com">maxi.ottino@gmail.com</a>.</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/ottino" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com/ottinomax" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 Maxi.
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://hba.sid.one/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
